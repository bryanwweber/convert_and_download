sudo: false
language: generic

# Only build on tags
if: tag IS present

env:
  global:
    secure: XN2GwFPIaD7vRYw3cYUp/+M+diTd4CZwf5TmlE+l1YFx8Eb/SuE45pJejsPsEc6A3lnR8LmUnosIofDjVL+FNaKJ9cvQK0bzkNzY3ApjRxhKc1s/VeOQSo78C1ADgQ/ocN7IkcblqamE+dcG9UWOQTh1dd/5gsnd3OCv1yev89hLBUlXFjIfPq65lEACUciNVfL6r3i2SLratbpFCo8/lqA277ihVDVkIbNDpXGNmq91mFTDf2pZYFk0kgDKrh700silJe4/VZaKiKAcghX5svD1O46JWskRtFlNzfUy+ksyR4jQGTdQhQa1V39DZvAGuspadddIRVJ6UqgttVdrF5sNZFaK8b27Y4ptgwVODj+dyhmkBZNEr1EmxRX1hHfas9j0T8yYuI/4nEesVu9KHvsSv5oloYnkJtQMejDX+B9sTadGnniJNw7n61z/X/c1BXjSNhoJSDsFXA+1N5I1RLyW7c1WJZrRgaQQhOWrfRrgvit/w5QbQmjWlG5oIlUFEi/8UYP+tL1HXkFsOg+szk+N4jbO+7g+TTxYcBH4hSpLGRyoN4D5nWDycVxXAiSI4IkuXA5ul8ohxOZbjUMJDCkO+3pGqWgdVzHKXgCOQ+XTLSS7s+7YvquoCmNfRT7haG4sxsoMrBAk3JJxYL9wIE23bXrtWNyOSKBVdYq12iU=

install:
  - wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
  - bash miniconda.sh -b -p $HOME/miniconda
  - rm miniconda.sh
  - source $HOME/miniconda/etc/profile.d/conda.sh && conda activate
  - conda config --set always_yes yes --set changeps1 no
  - conda update -q conda
  - conda update -q --all
  - conda config --append channels conda-forge
  - conda config --add channels bryanwweber
  - conda install conda-build anaconda-client conda-verify
  - conda info -a
  - conda list

script:
  - set -e
  - conda build conda.recipe
  - anaconda -t $ANACONDA_TOKEN upload $HOME/miniconda/conda-bld/*/convert_and_download*.tar.bz2

deploy:
  provider: pypi
  user: bryanwweber
  on:
    tags: true
  distributions: sdist bdist_wheel
  skip_upload_docs: true
  password:
    secure: 0zTELgO4xq3QYZvvIXv5ZjnDGKC5Cnfv2dnkWxxidpuqXaWwWKw3yykkESUHOBQ1at9Enjd+cf+xRulbalp5rsBSe0On9czGFKN90jjHTtmh3j0aFHqPQeVbJdv9fTIuAzV0/4VuIwlvMEcqzZnhkb/w++w9QNXLbft03Tghbhe8l8xyBTnHfCmggNN46xX80i/aVG70M89C1w4e6c9/5W3uVwW3RL7y0KO+HcM6JMpzwShDyWnaetVU11vaflhEyVLTqpn/7FU27yxIbGOdT3TP/6WJ1BJVWZuCviO+vm8cZLeu8Hs/k24YedncMHohf3DXBVs1XxXxaY9DL57bKjMuOw6gfuHY8bFlkfcAipTNIGzLMCHUvWT9+Uob7f+n80lGGhmJaG6pl+0zWEjf9AR0DdMwjlEIeJLeno9rp5rLsA9JLNDulFmmfHT83jHN81LmSYqfSeQdRlhVJ4mqfvuQRlAFMXv2HHqP1pbMID01Xl/fLz4Sgl41ZxdYK6WQlQIrlhXpWB8ocjUrWZHEfc6VYygXFwI02vBCEx1Gk4UQyBF2/coD9tcTbwBeRORGp0QfhCyHzjt3wSd31a6Day4x/vPe28HGyzaB8PPqfJYVM7c+cm3QPGCKxLlU9aQMP91vcpaOCfZr9iXLA7zDNwevPr1EGX1VQ2roVUTcHtY=
