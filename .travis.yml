sudo: false
language: generic

# Only build on tags
if: tag IS present

env:
  global:
    secure: e1dMTWPsVJBqHEWj4EQjfMKxNO7KNxQCC/Bv54ls5vb79CtLfoO+Nh8EqgLj8K+fnKGO9GHVdFOulVOy75teC7BH7ePmbAKEoIQn0lKaljzSQsU62Twehfs/ljtsxDdUJC58dcW6BkHTVyzzWewFZHKVHqotxYR48wIRPPPpIY2kd5E5Dq28wu9ZCoGoOdAkhBETVADp8+35LjmCDeNMRzx86TZgnSI6eWIy+SZT2vzIVY8O9Tq5stwXa22TpCEeumnhJwXmYdddIlRJ73ZTX8OMKUPOVWE9LoVZT7/R78YlEd1u2JhK4WQuApRNCcEKrVgSHAb9AQVHYza7mbaFAAxIX8nRt46+Edad91Jooq/qpIf1Iy7e5xQFqeUKj+++QLbTZbrk6ExoXOP+5hHmq26n39IW9YqrPPqfi6wEmy+R7igAevbmexslpIUl+dfCqVTcSsQjAhxIEUHbVJX+Z5Msb/0dvWG8Hp+vzvnSBkDJimUyt/1BBKGRPC+S2cXVLwqY0eGaBmPUiO2Wa8USyXdcn+IHBuOzNSE4JFNDsky61KNSKPMOHFxqRjhx/tDuFI+6laliTSKh8XjebscMd3LLjNgL42F/2Ic3xXISDkpTBWGo7beGREvh5wtY74sNJlNO3UwKleokasdutp/+y/71TG6h9m7Qzz/4adwuIAs=

install:
  - wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
  - bash miniconda.sh -b -p $HOME/miniconda
  - rm miniconda.sh
  - source $HOME/miniconda/etc/profile.d/conda.sh && conda activate
  - conda config --set always_yes yes --set changeps1 no
  - conda update -q conda
  - conda update -q --all
  - conda config --append channels conda-forge
  - conda config --add channels bryanwweber
  - conda install conda-build anaconda-client conda-verify
  - conda info -a
  - conda list

script:
  - set -e
  - conda build conda.recipe
  - anaconda -t $ANACONDA_TOKEN upload $HOME/miniconda/conda-bld/*/convert_and_download*.tar.bz2

deploy:
  provider: pypi
  user: bryanwweber
  on:
    tags: true
  distributions: sdist bdist_wheel
  skip_upload_docs: true
  password:
    secure: 0zTELgO4xq3QYZvvIXv5ZjnDGKC5Cnfv2dnkWxxidpuqXaWwWKw3yykkESUHOBQ1at9Enjd+cf+xRulbalp5rsBSe0On9czGFKN90jjHTtmh3j0aFHqPQeVbJdv9fTIuAzV0/4VuIwlvMEcqzZnhkb/w++w9QNXLbft03Tghbhe8l8xyBTnHfCmggNN46xX80i/aVG70M89C1w4e6c9/5W3uVwW3RL7y0KO+HcM6JMpzwShDyWnaetVU11vaflhEyVLTqpn/7FU27yxIbGOdT3TP/6WJ1BJVWZuCviO+vm8cZLeu8Hs/k24YedncMHohf3DXBVs1XxXxaY9DL57bKjMuOw6gfuHY8bFlkfcAipTNIGzLMCHUvWT9+Uob7f+n80lGGhmJaG6pl+0zWEjf9AR0DdMwjlEIeJLeno9rp5rLsA9JLNDulFmmfHT83jHN81LmSYqfSeQdRlhVJ4mqfvuQRlAFMXv2HHqP1pbMID01Xl/fLz4Sgl41ZxdYK6WQlQIrlhXpWB8ocjUrWZHEfc6VYygXFwI02vBCEx1Gk4UQyBF2/coD9tcTbwBeRORGp0QfhCyHzjt3wSd31a6Day4x/vPe28HGyzaB8PPqfJYVM7c+cm3QPGCKxLlU9aQMP91vcpaOCfZr9iXLA7zDNwevPr1EGX1VQ2roVUTcHtY=
